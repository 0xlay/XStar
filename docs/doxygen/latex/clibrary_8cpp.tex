\hypertarget{clibrary_8cpp}{}\doxysection{kernel\+\_\+space/runtime/clibrary.cpp File Reference}
\label{clibrary_8cpp}\index{kernel\_space/runtime/clibrary.cpp@{kernel\_space/runtime/clibrary.cpp}}
{\ttfamily \#include \char`\"{}clibrary.\+hpp\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void $\ast$\+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a80f02c6461f5469b252ce44a7cbec653}{malloc}} (size\+\_\+t size) noexcept
\item 
void \+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a473ea057c744e96b74129c5d82cd8b44}{free}} (void $\ast$ptr) noexcept
\item 
void $\ast$\+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a7353decf48412ebe8d90f2bc3369e551}{calloc}} (size\+\_\+t num, size\+\_\+t size) noexcept
\item 
void $\ast$\+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a929eb5ddeef759a6c5a1380e8cd98964}{realloc}} (void $\ast$ptr, size\+\_\+t new\+\_\+size) noexcept
\item 
void $\ast$ \mbox{\hyperlink{clibrary_8cpp_a592837a6fb94ee3a74ea4fe8411affe1}{vmalloc}} (size\+\_\+t size) noexcept
\item 
void \+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a36c2c0f0f47a5845d284f8f131f70afe}{vfree}} (void $\ast$ptr) noexcept
\item 
void $\ast$\+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a0aedf5b53946e196e0e3866c48a6752c}{vcalloc}} (size\+\_\+t num, size\+\_\+t size) noexcept
\item 
void $\ast$\+\_\+\+\_\+cdecl \mbox{\hyperlink{clibrary_8cpp_a5e023920d8c624a90c853b25a78448f1}{vrealloc}} (void $\ast$ptr, size\+\_\+t new\+\_\+size) noexcept
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{clibrary_8cpp_a7353decf48412ebe8d90f2bc3369e551}\label{clibrary_8cpp_a7353decf48412ebe8d90f2bc3369e551}} 
\index{clibrary.cpp@{clibrary.cpp}!calloc@{calloc}}
\index{calloc@{calloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{calloc()}{calloc()}}
{\footnotesize\ttfamily void $\ast$\+\_\+\+\_\+cdecl calloc (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{num,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00074}{74}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00075 \{}
\DoxyCodeLine{00076     \textcolor{keywordtype}{size\_t} size\_ = num * size;}
\DoxyCodeLine{00077     ASSERT(size\_ != 0);}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079     \textcolor{keywordtype}{void}* ptr = \mbox{\hyperlink{clibrary_8cpp_a80f02c6461f5469b252ce44a7cbec653}{malloc}}(size\_);}
\DoxyCodeLine{00080     \textcolor{keywordflow}{if} (!ptr)}
\DoxyCodeLine{00081         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00082     }
\DoxyCodeLine{00083     \textcolor{keywordflow}{return} RtlZeroMemory(ptr, size\_);}
\DoxyCodeLine{00084 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a473ea057c744e96b74129c5d82cd8b44}\label{clibrary_8cpp_a473ea057c744e96b74129c5d82cd8b44}} 
\index{clibrary.cpp@{clibrary.cpp}!free@{free}}
\index{free@{free}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{free()}{free()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+cdecl free (\begin{DoxyParamCaption}\item[{void $\ast$}]{ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00061}{61}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00062 \{}
\DoxyCodeLine{00063     \textcolor{keywordflow}{if} (ptr)}
\DoxyCodeLine{00064     \{}
\DoxyCodeLine{00065         ExFreePoolWithTag(}
\DoxyCodeLine{00066             \mbox{\hyperlink{clibrary_8hpp_a0a4b1dd0c173e8647383f0f1424a456a}{getBasePointer}}(ptr), \textcolor{comment}{/* returns the base address of an instance of a structure */}}
\DoxyCodeLine{00067             \mbox{\hyperlink{meminfo_8hpp_a45e4ad6094e82ff6fed2383ff09a8ade}{\_XSTAR\_LIBRARY\_TAG\_}}}
\DoxyCodeLine{00068         );}
\DoxyCodeLine{00069         ptr = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00070     \}}
\DoxyCodeLine{00071 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a80f02c6461f5469b252ce44a7cbec653}\label{clibrary_8cpp_a80f02c6461f5469b252ce44a7cbec653}} 
\index{clibrary.cpp@{clibrary.cpp}!malloc@{malloc}}
\index{malloc@{malloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{malloc()}{malloc()}}
{\footnotesize\ttfamily void $\ast$\+\_\+\+\_\+cdecl malloc (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00030}{30}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031 \{}
\DoxyCodeLine{00032     ASSERT(size != 0);}
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034 \textcolor{preprocessor}{    \#if (NTDDI\_VERSION >= NTDDI\_WIN10\_VB) }\textcolor{comment}{// minimum Windows 10 2004}}
\DoxyCodeLine{00035     \mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}} memoryBlock = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(}
\DoxyCodeLine{00036         ExAllocatePool2(}
\DoxyCodeLine{00037             POOL\_FLAG\_NON\_PAGED | POOL\_FLAG\_CACHE\_ALIGNED,}
\DoxyCodeLine{00038             size + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{MEMBLOCK}}),}
\DoxyCodeLine{00039             \mbox{\hyperlink{meminfo_8hpp_a45e4ad6094e82ff6fed2383ff09a8ade}{\_XSTAR\_LIBRARY\_TAG\_}}}
\DoxyCodeLine{00040         )}
\DoxyCodeLine{00041     );}
\DoxyCodeLine{00042 \textcolor{preprocessor}{    \#else }\textcolor{comment}{// deprecated in Windows 10 2004}}
\DoxyCodeLine{00043     \mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}} memoryBlock = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(}
\DoxyCodeLine{00044         ExAllocatePoolWithTag(}
\DoxyCodeLine{00045             NonPagedPoolNxCacheAligned, \textcolor{comment}{// alignment}}
\DoxyCodeLine{00046             size + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{MEMBLOCK}}),}
\DoxyCodeLine{00047             \_C\_LIBRARY\_TAG\_}
\DoxyCodeLine{00048         )}
\DoxyCodeLine{00049     );}
\DoxyCodeLine{00050 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052     \textcolor{keywordflow}{if} (!memoryBlock)}
\DoxyCodeLine{00053         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055     memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a7022b77025ce284a7a1e46390274654e}{size}} = size;}
\DoxyCodeLine{00056     memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a2236e91a4b92364a9568d25d69ec40f6}{data}} = \mbox{\hyperlink{clibrary_8hpp_abea415c8f6dfb8cbc2478170de165a8f}{getDataPointer}}(memoryBlock);}
\DoxyCodeLine{00057     \textcolor{keywordflow}{return} memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a2236e91a4b92364a9568d25d69ec40f6}{data}};}
\DoxyCodeLine{00058 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a929eb5ddeef759a6c5a1380e8cd98964}\label{clibrary_8cpp_a929eb5ddeef759a6c5a1380e8cd98964}} 
\index{clibrary.cpp@{clibrary.cpp}!realloc@{realloc}}
\index{realloc@{realloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{realloc()}{realloc()}}
{\footnotesize\ttfamily void $\ast$\+\_\+\+\_\+cdecl realloc (\begin{DoxyParamCaption}\item[{void $\ast$}]{ptr,  }\item[{size\+\_\+t}]{new\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00087}{87}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088 \{}
\DoxyCodeLine{00089     \textcolor{keywordtype}{size\_t} current\_size = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(\mbox{\hyperlink{clibrary_8hpp_a0a4b1dd0c173e8647383f0f1424a456a}{getBasePointer}}(ptr))-\/>size;}
\DoxyCodeLine{00090     \textcolor{keywordflow}{if} (current\_size <= new\_size)}
\DoxyCodeLine{00091         \textcolor{keywordflow}{return} ptr;}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093     \mbox{\hyperlink{clibrary_8cpp_a473ea057c744e96b74129c5d82cd8b44}{free}}(ptr);}
\DoxyCodeLine{00094     ptr = \mbox{\hyperlink{clibrary_8cpp_a80f02c6461f5469b252ce44a7cbec653}{malloc}}(new\_size);}
\DoxyCodeLine{00095     \textcolor{keywordflow}{return} ptr;}
\DoxyCodeLine{00096 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a0aedf5b53946e196e0e3866c48a6752c}\label{clibrary_8cpp_a0aedf5b53946e196e0e3866c48a6752c}} 
\index{clibrary.cpp@{clibrary.cpp}!vcalloc@{vcalloc}}
\index{vcalloc@{vcalloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{vcalloc()}{vcalloc()}}
{\footnotesize\ttfamily void $\ast$\+\_\+\+\_\+cdecl vcalloc (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{num,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00144}{144}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00145 \{}
\DoxyCodeLine{00146     PAGED\_CODE();}
\DoxyCodeLine{00147     \textcolor{keywordtype}{size\_t} size\_ = num * size;}
\DoxyCodeLine{00148     ASSERT(size\_ != 0);}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150     \textcolor{keywordtype}{void}* ptr = \mbox{\hyperlink{clibrary_8cpp_a592837a6fb94ee3a74ea4fe8411affe1}{vmalloc}}(size\_);}
\DoxyCodeLine{00151     \textcolor{keywordflow}{if} (!ptr)}
\DoxyCodeLine{00152         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00153 }
\DoxyCodeLine{00154     \textcolor{keywordflow}{return} RtlZeroMemory(ptr, size\_);}
\DoxyCodeLine{00155 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a36c2c0f0f47a5845d284f8f131f70afe}\label{clibrary_8cpp_a36c2c0f0f47a5845d284f8f131f70afe}} 
\index{clibrary.cpp@{clibrary.cpp}!vfree@{vfree}}
\index{vfree@{vfree}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{vfree()}{vfree()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+cdecl vfree (\begin{DoxyParamCaption}\item[{void $\ast$}]{ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00137}{137}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138 \{}
\DoxyCodeLine{00139     PAGED\_CODE();}
\DoxyCodeLine{00140     \mbox{\hyperlink{clibrary_8cpp_a473ea057c744e96b74129c5d82cd8b44}{free}}(ptr);}
\DoxyCodeLine{00141 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a592837a6fb94ee3a74ea4fe8411affe1}\label{clibrary_8cpp_a592837a6fb94ee3a74ea4fe8411affe1}} 
\index{clibrary.cpp@{clibrary.cpp}!vmalloc@{vmalloc}}
\index{vmalloc@{vmalloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{vmalloc()}{vmalloc()}}
{\footnotesize\ttfamily void $\ast$ vmalloc (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00106}{106}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00107 \{}
\DoxyCodeLine{00108     PAGED\_CODE();}
\DoxyCodeLine{00109     ASSERT(size != 0);}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111 \textcolor{preprocessor}{    \#if (NTDDI\_VERSION >= NTDDI\_WIN10\_VB) }\textcolor{comment}{// minimum Windows 10 2004}}
\DoxyCodeLine{00112     \mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}} memoryBlock = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(}
\DoxyCodeLine{00113         ExAllocatePool2(}
\DoxyCodeLine{00114             POOL\_FLAG\_PAGED | POOL\_FLAG\_CACHE\_ALIGNED,}
\DoxyCodeLine{00115             size + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{MEMBLOCK}}),}
\DoxyCodeLine{00116             \mbox{\hyperlink{meminfo_8hpp_a45e4ad6094e82ff6fed2383ff09a8ade}{\_XSTAR\_LIBRARY\_TAG\_}}}
\DoxyCodeLine{00117         )}
\DoxyCodeLine{00118     );}
\DoxyCodeLine{00119 \textcolor{preprocessor}{    \#else }\textcolor{comment}{// deprecated in Windows 10 2004}}
\DoxyCodeLine{00120     \mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}} memoryBlock = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(}
\DoxyCodeLine{00121         ExAllocatePoolWithTag(}
\DoxyCodeLine{00122             PagedPoolCacheAligned, \textcolor{comment}{// alignment}}
\DoxyCodeLine{00123             size + \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{MEMBLOCK}}),}
\DoxyCodeLine{00124             \_C\_LIBRARY\_TAG\_}
\DoxyCodeLine{00125         )}
\DoxyCodeLine{00126     );}
\DoxyCodeLine{00127 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{00128     \textcolor{keywordflow}{if} (!memoryBlock)}
\DoxyCodeLine{00129         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00130     }
\DoxyCodeLine{00131     memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a7022b77025ce284a7a1e46390274654e}{size}} = size;}
\DoxyCodeLine{00132     memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a2236e91a4b92364a9568d25d69ec40f6}{data}} = \mbox{\hyperlink{clibrary_8hpp_abea415c8f6dfb8cbc2478170de165a8f}{getDataPointer}}(memoryBlock);}
\DoxyCodeLine{00133     \textcolor{keywordflow}{return} memoryBlock-\/>\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k_a2236e91a4b92364a9568d25d69ec40f6}{data}};}
\DoxyCodeLine{00134 \}}

\end{DoxyCode}
\mbox{\Hypertarget{clibrary_8cpp_a5e023920d8c624a90c853b25a78448f1}\label{clibrary_8cpp_a5e023920d8c624a90c853b25a78448f1}} 
\index{clibrary.cpp@{clibrary.cpp}!vrealloc@{vrealloc}}
\index{vrealloc@{vrealloc}!clibrary.cpp@{clibrary.cpp}}
\doxysubsubsection{\texorpdfstring{vrealloc()}{vrealloc()}}
{\footnotesize\ttfamily void $\ast$\+\_\+\+\_\+cdecl vrealloc (\begin{DoxyParamCaption}\item[{void $\ast$}]{ptr,  }\item[{size\+\_\+t}]{new\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line \mbox{\hyperlink{clibrary_8cpp_source_l00158}{158}} of file \mbox{\hyperlink{clibrary_8cpp_source}{clibrary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00159 \{}
\DoxyCodeLine{00160     PAGED\_CODE();}
\DoxyCodeLine{00161     \textcolor{keywordtype}{size\_t} current\_size = \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct___m_e_m_b_l_o_c_k}{PMEMBLOCK}}\textcolor{keyword}{>}(\mbox{\hyperlink{clibrary_8hpp_a0a4b1dd0c173e8647383f0f1424a456a}{getBasePointer}}(ptr))-\/>size;}
\DoxyCodeLine{00162     \textcolor{keywordflow}{if} (current\_size <= new\_size)}
\DoxyCodeLine{00163         \textcolor{keywordflow}{return} ptr;}
\DoxyCodeLine{00164 }
\DoxyCodeLine{00165     \mbox{\hyperlink{clibrary_8cpp_a36c2c0f0f47a5845d284f8f131f70afe}{vfree}}(ptr);}
\DoxyCodeLine{00166     ptr = \mbox{\hyperlink{clibrary_8cpp_a592837a6fb94ee3a74ea4fe8411affe1}{vmalloc}}(new\_size);}
\DoxyCodeLine{00167     \textcolor{keywordflow}{return} ptr;}
\DoxyCodeLine{00168 \}}

\end{DoxyCode}
